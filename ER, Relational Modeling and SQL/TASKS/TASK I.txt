#TASK I

CREATE VIEW NUMBER_OF_2020_ASSESSMENTS AS
SELECT COUNT(assessment.A_CODE) AS COUNT_2020
FROM assessment
WHERE YEAR(assessment.date)=2020;

CREATE VIEW TOTAL_NUMBER_OF_POPULATION AS
SELECT SUM(location.POPULATION) AS TOTAL_POPULATION
FROM location;

SELECT  location.L_CODE AS LOCATION_CODE, COUNT(assessment.A_CODE)/COUNT_2020*100 AS PERCENT_ASSESSMENT, location.POPULATION/TOTAL_POPULATION*100 AS PERCENT_POPULATION
FROM NUMBER_OF_2020_ASSESSMENTS,TOTAL_NUMBER_OF_POPULATION,realestate
INNER JOIN location ON (location.L_CODE=realestate.L_CODE) 
LEFT JOIN assessment ON (realestate.RE_ID = assessment.RE_ID AND YEAR(assessment.DATE)=2020)
GROUP BY location.L_CODE;