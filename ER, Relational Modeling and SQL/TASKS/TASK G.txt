#TASK G

CREATE VIEW OFFICES_ASS AS
SELECT auditor.AU_ID AS AUDITOR_ID, assessment.DATE AS DATE_OF_ASSESSMENT, COUNT(offices.RE_ID) AS TOTAL_OFFICE_ASSESSMENTS_2020
FROM offices,assessment,auditor
WHERE offices.RE_ID=assessment.RE_ID
AND YEAR(assessment.DATE)=2020
AND assessment.AU_ID=auditor.AU_ID
GROUP BY auditor.AU_ID ;

CREATE VIEW HOUSES_ASS AS
SELECT auditor.AU_ID AS AUDITOR_ID,assessment.DATE AS DATE_OF_ASSESSMENT, COUNT(houses.RE_ID) AS TOTAL_HOUSE_ASSESSMENTS_2020
FROM houses,assessment,auditor
WHERE houses.RE_ID=assessment.RE_ID
AND YEAR(assessment.DATE)=2020 
AND assessment.AU_ID=auditor.AU_ID
GROUP BY auditor.AU_ID ;

SELECT auditor.AU_ID AS AUDITOR_ID, TOTAL_OFFICE_ASSESSMENTS_2020, TOTAL_HOUSE_ASSESSMENTS_2020
FROM auditor
LEFT JOIN HOUSES_ASS ON (auditor.AU_ID=houses_ass.AUDITOR_ID)
LEFT JOIN OFFICES_ASS ON (auditor.AU_ID=offices_ass.AUDITOR_ID) 
GROUP BY auditor.AU_ID;